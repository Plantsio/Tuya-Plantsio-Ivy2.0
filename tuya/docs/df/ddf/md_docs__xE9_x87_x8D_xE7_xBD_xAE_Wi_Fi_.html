<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TuyaOS: 重置(Wi-Fi)</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TuyaOS
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- 制作者 Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search",'搜索','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','搜索');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">重置(Wi-Fi) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >重置是把设备状态重新恢复到配网、激活之前状态的操作，分为本地重置和APP重置，同时重置也分为普通重置和恢复出厂设置重置。</p>
<p ><code>Wi-Fi</code>设备重置的时候，还会和Wi-Fi工作模式关联起来，具体细节见Wi-Fi工作模式。</p>
<h1><a class="anchor" id="autotoc_md21"></a>
本地重置</h1>
<p >本地重置一般是设备触发按钮、按键的形式，对设备进行恢复到配网、激活之前状态的操作。设备重置的时候，会通过<code>Atop</code>接口和云端进行交互，同步设备已经被重置了的信息，并调用应用注册的重置回调<code>gw_reset_cb</code>，同时会清除设备状态信息，以及配置下来的定时任务、天文定时任务等，然后进行设备重启。</p>
<p >本地重置和恢复出厂设置重置，差别是恢复出厂设置重置会将设备的<code>schema</code>信息清除。</p>
<h1><a class="anchor" id="autotoc_md22"></a>
APP重置</h1>
<p >APP重置是从APP上发起移除、删除，让设备进行恢复到配网、激活之前状态的操作。APP操作之后，会通过云端向设备发送涂鸦<code>MQTT</code>协议<code>RESET</code>命令，设备收到根据重置类型，选择进行重置或者是恢复出厂设置重置。设备会通过<code>Atop</code>接口和云端进行交互，同步设备已经被重置了的信息，调用应用注册的重置回调<code>gw_reset_cb</code>，同时会清除设备状态信息，以及配置下来的定时任务、天文定时任务等，然后进行设备重启。</p>
<p >APP重置和恢复出厂设置重置，差别是恢复出厂设置重置会将设备的<code>schema</code>信息清除。</p>
<p >APP恢复出厂设置重置，会清除涂鸦<code>IoT</code>平台上的设备信息，设备下一次激活，将会使用新的<code>devid</code>。</p>
<h1><a class="anchor" id="autotoc_md23"></a>
接口描述</h1>
<h2><a class="anchor" id="autotoc_md24"></a>
设备本地重置</h2>
<div class="fragment"><div class="line"> </div>
<div class="line">OPERATE_RET <a class="code hl_function" href="../../d1/d49/tuya__iot__wifi__api_8h.html#a05df1c3d4d016a9ae4974ae1f99b6dae">tuya_iot_wf_gw_unactive</a>(VOID);</div>
<div class="ttc" id="atuya__iot__wifi__api_8h_html_a05df1c3d4d016a9ae4974ae1f99b6dae"><div class="ttname"><a href="../../d1/d49/tuya__iot__wifi__api_8h.html#a05df1c3d4d016a9ae4974ae1f99b6dae">tuya_iot_wf_gw_unactive</a></div><div class="ttdeci">OPERATE_RET tuya_iot_wf_gw_unactive(VOID)</div><div class="ttdoc">tuya_iot_wf_gw_unactive</div></div>
</div><!-- fragment --><p >此接口对设备进行本地重置操作，本地重置操作会对通知云端设备已经被云端移除了，并对设备进行工作状态重置，清除一些数据，如定时信息。同时会调用初始化提供的<code>gw_reset_cb</code>回调函数。</p>
<h2><a class="anchor" id="autotoc_md25"></a>
设备本地重置并切换模式</h2>
<div class="fragment"><div class="line"> </div>
<div class="line">OPERATE_RET <a class="code hl_function" href="../../d1/d49/tuya__iot__wifi__api_8h.html#ae46384a6a74d46b6ea65ded85f25f3c1">tuya_iot_wf_gw_fast_unactive</a>(IN CONST GW_WF_CFG_MTHD_SEL mthd, IN CONST GW_WF_START_MODE wifi_start_mode);</div>
<div class="ttc" id="atuya__iot__wifi__api_8h_html_ae46384a6a74d46b6ea65ded85f25f3c1"><div class="ttname"><a href="../../d1/d49/tuya__iot__wifi__api_8h.html#ae46384a6a74d46b6ea65ded85f25f3c1">tuya_iot_wf_gw_fast_unactive</a></div><div class="ttdeci">OPERATE_RET tuya_iot_wf_gw_fast_unactive(IN CONST GW_WF_CFG_MTHD_SEL mthd, IN CONST GW_WF_START_MODE wifi_start_mode)</div><div class="ttdoc">tuya_iot_wf_gw_fast_unactive</div></div>
</div><!-- fragment --><p >此接口对设备进行本地重置，重置会对通知云端设备已经被云端移除了，并对设备进行工作状态重置，清除一些数据，如定时信息。同时会调用初始化提供的<code>gw_reset_cb</code>回调函数。</p>
<p >在重置之后设备会重新启动，并且按照新的<code>mthd</code>和<code>wifi_start_mode</code>启动。</p>
<h2><a class="anchor" id="autotoc_md26"></a>
设备恢复出厂设置</h2>
<div class="fragment"><div class="line"> </div>
<div class="line">OPERATE_RET <a class="code hl_function" href="../../d1/d49/tuya__iot__wifi__api_8h.html#a1546c3cc4640e12010b69a4b309065fe">tuya_iot_wf_gw_reset</a>(VOID);</div>
<div class="ttc" id="atuya__iot__wifi__api_8h_html_a1546c3cc4640e12010b69a4b309065fe"><div class="ttname"><a href="../../d1/d49/tuya__iot__wifi__api_8h.html#a1546c3cc4640e12010b69a4b309065fe">tuya_iot_wf_gw_reset</a></div><div class="ttdeci">OPERATE_RET tuya_iot_wf_gw_reset(VOID)</div><div class="ttdoc">tuya_iot_wf_gw_reset</div></div>
</div><!-- fragment --><p >此接口对设备进行本地恢复出厂设置操作，本地恢复出厂设置操作会对通知云端设备已经被云端移除了，并对设备进行工作状态重置，清除一些数据，如定时信息，同时清除<code>schema</code>信息，同时会调用初始化提供的<code>gw_reset_cb</code>回调函数。</p>
<h1><a class="anchor" id="autotoc_md27"></a>
示例代码</h1>
<div class="fragment"><div class="line"><span class="comment">// 设备重置</span></div>
<div class="line"><span class="keywordtype">void</span> test_local_unactive()</div>
<div class="line">{</div>
<div class="line">    TUYA_CALL_ERR_LOG(<a class="code hl_function" href="../../d1/d49/tuya__iot__wifi__api_8h.html#a05df1c3d4d016a9ae4974ae1f99b6dae">tuya_iot_wf_gw_unactive</a>());</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 设备恢复出厂设置重置</span></div>
<div class="line"><span class="keywordtype">void</span> test_local_reset()</div>
<div class="line">{</div>
<div class="line">    TUYA_CALL_ERR_LOG(<a class="code hl_function" href="../../d1/d49/tuya__iot__wifi__api_8h.html#a1546c3cc4640e12010b69a4b309065fe">tuya_iot_wf_gw_reset</a>());</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
制作者&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
